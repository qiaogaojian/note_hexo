---
title: GPU å®æ—¶ç›‘æ§å·¥å…· nvitop
date: 2024-10-23 15:11:34
categories: ['6.å·¥å…·', 'AI', 'ç›‘æ§']
tags: ['å·¥å…·', 'ç›‘æ§', 'AI']
---

> åŸæ–‡åœ°å€ [mp.weixin.qq.com](https://mp.weixin.qq.com/s/SlOJZmF08v3-6o6rXWIHaQ)

![](https://mmbiz.qpic.cn/mmbiz_png/oAH7GxxkX4qI7iaeTpaq6GnL2eXOic81xfPEyzGhqefZpbicPgUfn8vgDbXhqBYqQaB9ylK0KZ7uCnpnkz1HtgxMA/640?wx_fmt=png)

github åœ°å€: https://github.com/XuehaiPan/nvitop
  
  
## å¼•è¨€ 8

ç›¸ä¿¡å¤§å®¶åœ¨ç”¨ NVIDIA-GPU è®­ç»ƒç½‘ç»œæ¨¡å‹çš„æ—¶å€™ï¼Œéƒ½ä¼šä¹ æƒ¯æ€§çš„åœ¨ç»ˆç«¯`nvidia-smi`ä¸€ä¸‹å§ï¼Ÿæœ€ç›´æ¥çš„ç›®çš„æ˜¯ä¸ºäº†æŸ¥çœ‹å“ªäº›å¡æ­£åœ¨ä½¿ç”¨ï¼Œå“ªäº›å¡å¤„åœ¨ç©ºé—²ï¼Œç„¶åæŒ‘é€‰ç©ºé—²çš„å¡å·è¿›è¡Œç½‘ç»œè®­ç»ƒã€‚

**ã€Œäº†è§£å“ªå—å¡å¤„åœ¨ç©ºé—²åªæ˜¯æ™®é€šç®—æ³•å·¥ç¨‹å¸ˆçš„æ™®é€šéœ€æ±‚ã€**

å’±ä»¬ä½œä¸ºä¸€åèµ„æ·±çš„ç®—æ³•å·¥ç¨‹å¸ˆï¼Œæ¯•ç«Ÿèº«å…¼å¤šèŒï¼šä¸Šè¦å¼€å‘ AI ç®—æ³•ï¼Œä¸‹è¦ç®¡ç†æœåŠ¡å™¨ï¼Œå·¦è¦å¸¦æ–°äººï¼Œå³è¦ PPT æ±‡æŠ¥ä¸Šçº§ã€‚

å¯¹äºç®¡ç†æœåŠ¡å™¨ï¼šåˆšä¹°çš„æ–°æœåŠ¡å™¨ä½ å¾—è£…ç³»ç»Ÿå§ï¼Ÿå¾—è£…`Driver`ï¼Œ`Cuda`ï¼Œ`Cudnn`å§ï¼Ÿæ—¶ä¸æ—¶è¿˜å¾—ç›¯ä¸€ä¸‹æœåŠ¡å™¨å„ä¸ªå¡çš„è¿è¡ŒçŠ¶å†µï¼Œæ¯•ç«Ÿåˆšå…¥èŒçš„å°å¹´é’æœ‰æ—¶å€™ä¸€é¡¿æ“ä½œï¼Œä¸€ä¸ªäººå ç”¨å…¨æœåŠ¡å™¨ 95% ä»¥ä¸Šçš„å†…å­˜æŠŠæœåŠ¡å™¨ç›´æ¥å¡æ­»ä¹Ÿä¸æ˜¯æ²¡æœ‰å¯èƒ½ã€‚

`nvitop`æ˜¯ä¸€ä¸ªéå¸¸å…¨é¢çš„ NVIDIA-GPU è®¾å¤‡è¿è¡ŒçŠ¶å†µçš„å®æ—¶ç›‘æ§å·¥å…·ï¼Œå®ƒå°† GPU åˆ©ç”¨ç‡ï¼Œæ˜¾å­˜å æ¯”ï¼Œå¡å·ä½¿ç”¨è€…ï¼ŒCPU åˆ©ç”¨ç‡ï¼Œè¿›ç¨‹ä½¿ç”¨æ—¶é—´ï¼Œå‘½ä»¤è¡Œç­‰ç­‰é›†äºä¸€èº«ï¼Œå¹¶ä»¥å·®å¼‚åŒ–çš„é¢œè‰²è¿›è¡Œä¸ªæ€§åŒ–å±•ç¤ºï¼Œå®‰è£…è¿‡ç¨‹ä¹Ÿéå¸¸ç®€å•ï¼Œå¼ºçƒˆå¤§å®¶æ¨èä½¿ç”¨ï¼Œè®©è‡ªå·±åœ¨ç®¡ç†æœåŠ¡å™¨çš„æ—¶å€™äº‹åŠåŠŸå€ï¼

ä»¥ä¸‹å›¾ 1 å±•ç¤ºäº†`nvitop`å’Œ`nvidia-smi`å‘½ä»¤çš„ç•Œé¢å¯¹æ¯”ç»“æœï¼š

![](https://mmbiz.qpic.cn/mmbiz_png/oAH7GxxkX4oiapfe7dgr7JRYVRCvR3JKFf4jX1JDbK3BYK9oJicn2jRTKYtZTjjnegFxfcQWMfILx5rB7W6gYicJQ/640?wx_fmt=png)å›¾ 1. nvitop(å·¦) VS nvidia-smi(å³)
  
  
## nvitop æ•ˆæœå±•ç¤º

> **ã€ŒNviTopã€** An interactive NVIDIA-GPU process viewer and beyond, the one-stop solution for GPU process management.

`nvitop`æ˜¯ä¸€æ¬¾äº¤äº’å¼ NVIDIA-GPU è®¾å¤‡æ€§èƒ½ & èµ„æº & è¿›ç¨‹çš„å®æ—¶ç›‘æµ‹å·¥å…·ã€‚

ç›¸æ¯”äº`nvidia-smi`å‘½ä»¤ï¼Œ`nvitop`åœ¨å®æ—¶ç›‘æ§ GPU è®¾å¤‡èµ„æº & æ€§èƒ½ä¸Šå…·å¤‡å…¨æ–¹ä½ä¼˜åŠ¿ï¼š

*   ä»¥æ›´ç¾è§‚çš„é¢œè‰²ï¼Œå’Œæ›´ç›´è§‚çš„è¿›åº¦æ¡å®æ—¶å±•ç¤ºæŸå— GPU å¡æ‰€å¤„è¿›ç¨‹çš„ GPU&CPU å†…å­˜ä»¥åŠåˆ©ç”¨ç‡å æ¯”    
*   ä½œä¸ºèµ„æºç›‘æ§å™¨ï¼Œå®ƒåŒ…æ‹¬å¦‚ä¸‹åŠŸèƒ½ï¼šæ ‘çŠ¶è§†å›¾ã€ç¯å¢ƒå˜é‡æŸ¥çœ‹ã€è¿›ç¨‹è¿‡æ»¤ã€è¿›ç¨‹æŒ‡æ ‡æ£€æµ‹ç­‰    
*   å¯è¿½è¸ªæŸä¸ªå•é¡¹è¿›ç¨‹åœ¨ GPU&CPU ä¸Šå†…å­˜å’Œåˆ©ç”¨ç‡å æ¯”çš„å†å²çºªå½•ï¼Œå¹¶åˆ©ç”¨ Bar ç›´è§‚å±•ç¤º    
*   å¯ç›´è§‚å±•ç¤ºæŸå— GPU çš„ä½¿ç”¨è€…ã€ä½¿ç”¨æ—¶é—´ã€ä½¿ç”¨å‘½ä»¤è¡Œã€GPU å’Œ CPU å ç”¨ç‡è®°å½•    
*   å¯ä½¿ç”¨å·¥å…·æä¾›çš„ API æ­å»ºè‡ªå®šä¹‰ç›‘æ§å·¥å…·    

å®Œæ•´ API è¯´æ˜æ–‡æ¡£è¯·ç§»æ­¥ï¼šhttps://nvitop.readthedocs.io

ä»¥ä¸‹å±•ç¤ºäº† nvitop å‘½ä»¤å·¥å…·çš„éƒ¨åˆ†æ•ˆæœå›¾ï¼š![](https://mmbiz.qpic.cn/mmbiz_png/oAH7GxxkX4oiapfe7dgr7JRYVRCvR3JKFdP5kBEJGIyxTbRGCiaNLpft6tQW4efOFxbEicgNeXbkQ5szypAGfibd2A/640?wx_fmt=png)å›¾ 2. nvitop æœ‰å¤šç§ç›‘æ§æ¨¡å¼å¯ä¾›é€‰æ‹©![](https://mmbiz.qpic.cn/mmbiz_png/oAH7GxxkX4oiapfe7dgr7JRYVRCvR3JKFY6Z9XDFkzpDLP8jW53EtJbMxiaiaNV4fn1EkozeibmeSb6w28JpUgibF8g/640?wx_fmt=png)å›¾ 3. ç›‘æ§è¿‡ç¨‹ä¿¡æ¯è¿‡æ»¤å’Œä¸°å¯Œçš„è‰²å½©ç•Œé¢![](https://mmbiz.qpic.cn/mmbiz_png/oAH7GxxkX4oiapfe7dgr7JRYVRCvR3JKFkibtApLHIcO4rUUeMS4H6n6Kp1nKTbPMuoSUEr4zwKIGCl3xq7vfiboQ/640?wx_fmt=png)å›¾ 4. æ”¯æŒ MIG![](https://mmbiz.qpic.cn/mmbiz_png/oAH7GxxkX4oiapfe7dgr7JRYVRCvR3JKFJj8YajmmpFLib9dNqVSAsrYY58DgBOFZQlUQtry4jluKnI85LQEQuaw/640?wx_fmt=png) å›¾ 5. ç±»ä¼¼é¢‘è°±çš„æ¡å½¢å›¾ (with option --colorful)![](https://mmbiz.qpic.cn/mmbiz_png/oAH7GxxkX4oiapfe7dgr7JRYVRCvR3JKFJeIR6QNVqrMWmnsjElsXyKAgBSKPoicXkVEExeovz8TOU65TXNHdqLQ/640?wx_fmt=png) å›¾ 6. ç›‘æ§ç‰¹å®šè¿›ç¨‹çš„å…³é”®æ€§æ€§èƒ½æŒ‡æ ‡ (shortcut: Enter / Return).![](https://mmbiz.qpic.cn/mmbiz_png/oAH7GxxkX4oiapfe7dgr7JRYVRCvR3JKFE0z7fOPibGibZ3HTFNtiaayicwZOl1kzFpBBNvcVfv2nwGlJjL3FpCejRg/640?wx_fmt=png) å›¾ 7. nvitop åŒæ—¶ä¹Ÿæ”¯æŒ windows ç³»ç»Ÿ!
  
  
## nvitop ç‰¹æ€§

  
  
### ç›‘æ§ä¿¡æ¯ä¸°å¯Œä¸”å±•ç¤ºç›´è§‚

æ˜¾ç¤ºæ¯”`nvidia-smi`æ›´å…¨é¢çš„èµ„æºç›‘æ§ä¿¡æ¯ï¼Œå’Œæ›´ç›´è§‚çš„è¡¨ç°å½¢å¼
  
  
### ç›‘æ§æ¨¡å¼

å¯ä»¥ä½œä¸ºèµ„æºç›‘æ§å™¨ä¸€ç›´è¿è¡Œï¼Œè€Œä¸æ˜¯åªèƒ½å•ç‹¬æŸ¥çœ‹ä¸€æ¬¡ç»“æœ

*   æ”¯æŒæ¡å½¢å›¾å’Œå†å²å›¾    
*   ç›‘æ§ä¿¡æ¯æ’åº & ç›‘æ§ä¿¡æ¯è¿‡æ»¤    
*   å¯é€šè¿‡é”®ç›˜å‘è¿›ç¨‹å‘é€ä¿¡å·    
*   GPU è¿›ç¨‹åŠå…¶çˆ¶è¿›ç¨‹çš„æ ‘è§†å›¾å±å¹•äº«å—    
*   æä¾›ç¯å¢ƒå˜é‡å±å¹•ï¼Œå¸®åŠ©ä¿¡æ¯å±å¹•ï¼Œå¹¶æ”¯æŒé¼ æ ‡ç‚¹å‡»çš„äº¤äº’å¼æ“ä½œ    
  
  
### äº¤äº’å¼

å¯åœ¨ç›‘æ§æ¨¡å¼ä¸‹å“åº”ç”¨æˆ·è¾“å…¥ï¼ˆæ¥è‡ªé”®ç›˜æˆ–é¼ æ ‡ï¼‰ï¼Œæ¯”`gpustat`å’Œ`py3nvml`æ›´å…·ä¼˜åŠ¿
  
  
### é«˜æ•ˆæ€§

*   è¯¥å·¥å…·ç›´æ¥ä½¿ç”¨`NVML Python bindings`è¿›è¡Œç»‘å®šå¹¶æŸ¥è¯¢è®¾å¤‡è¿è¡ŒçŠ¶æ€ï¼Œè€Œä¸æ˜¯è§£æ`nvidia-smi`ï¼ˆä¸`nvidia-htop`ç›¸æ¯”ï¼‰    
*   `TTLCache`ä½¿ç”¨ from `cachetools`æ”¯æŒç¨€ç–æŸ¥è¯¢å’Œç¼“å­˜ç»“æœï¼ˆä¸`py3nvml`ç›¸æ¯”ï¼‰    
*   `curses`ä½¿ç”¨åº“è€Œä¸æ˜¯`print`ANSI è½¬ä¹‰ç æ˜¾ç¤ºä¿¡æ¯ï¼ˆä¸`py3nvml`ç›¸æ¯”ï¼‰    
*   ä½¿ç”¨å¤šçº¿ç¨‹å¼‚æ­¥æ”¶é›†ä¿¡æ¯å¹¶æ›´å¿«çš„å“åº”ç”¨æˆ·è¾“å…¥ï¼ˆä¸`nvtop`ç›¸æ¯”ï¼‰    
  
  
### ä¾¿æºæ€§

é€‚ç”¨äº`Linux`å’Œ`Windows`

*   ä½¿ç”¨è·¨å¹³å°åº“`psutil`è·å–ä¸»æœºè¿›ç¨‹ä¿¡æ¯ï¼Œè€Œä¸æ˜¯è°ƒç”¨`ps -p <pid>`å­è¿›ç¨‹ï¼ˆä¸`nvidia-htop`å’Œ`py3nvml`ç›¸æ¯”ï¼‰    
*   ç”¨çº¯`Python`ç¼–å†™ï¼Œæ”¯æŒ`pip`å®‰è£…ï¼ˆä¸`nvtop`ç›¸æ¯”ï¼‰    
  
  
### å¯é›†æˆ

æ˜“äºé›†æˆåˆ°å…¶å®ƒåº”ç”¨ç¨‹åºä¸­ï¼Œè€Œä¸ä»…ä»…æ˜¯ç›‘æ§åŠŸèƒ½ï¼ˆä¸`nvidia-htop`å’Œ`nvtop`ç›¸æ¯”ï¼‰
  
  
## å®‰è£…æŒ‡å—

> **ã€Œå®˜æ–¹å®‰è£…æ•™ç¨‹ã€** https://github.com/XuehaiPan/nvitop/blob/main/README.md

å› ä¸º`nvitop`é‡‡ç”¨çº¯`Python`ç¼–å†™ï¼Œæ‰€ä»¥æ¨èé‡‡ç”¨`pip`å‘½ä»¤è¿›è¡Œå®‰è£…ï¼š
```python
pipÂ installÂ nvitop
```
  
  
## ä½¿ç”¨æ–¹æ³•

  
  
### å‘½ä»¤è¡Œä½¿ç”¨æ–¹æ³•

```python
#Â MonitorÂ modeÂ (whenÂ theÂ displayÂ modeÂ isÂ omitted,Â `NVITOP_MONITOR_MODE`Â willÂ beÂ used)  
$Â nvitopÂ Â #Â orÂ useÂ `python3Â -mÂ nvitop`  
  
#Â AutomaticallyÂ configureÂ theÂ displayÂ modeÂ accordingÂ toÂ theÂ terminalÂ size  
$Â nvitopÂ -mÂ autoÂ Â Â Â Â #Â shortcut:Â `a`Â key  
  
#Â ArbitrarilyÂ displayÂ asÂ `full`Â mode  
$Â nvitopÂ -mÂ fullÂ Â Â Â Â #Â shortcut:Â `f`Â key  
  
#Â ArbitrarilyÂ displayÂ asÂ `compact`Â mode  
$Â nvitopÂ -mÂ compactÂ Â #Â shortcut:Â `c`Â key  
  
#Â SpecifyÂ queryÂ devicesÂ (byÂ integerÂ indices)  
$Â nvitopÂ -oÂ 0Â 1Â Â #Â onlyÂ showÂ <GPUÂ 0>Â andÂ <GPUÂ 1>  
  
#Â OnlyÂ showÂ devicesÂ inÂ `CUDA_VISIBLE_DEVICES`Â (byÂ integerÂ indicesÂ orÂ UUIDÂ strings)  
$Â nvitopÂ -ov  
  
#Â OnlyÂ showÂ GPUÂ processesÂ withÂ theÂ computeÂ contextÂ (type:Â 'C'Â orÂ 'C+G')  
$Â nvitopÂ -c  
  
#Â UseÂ ASCIIÂ charactersÂ only  
$Â nvitopÂ -UÂ Â #Â usefulÂ forÂ terminalsÂ withoutÂ UnicodeÂ support  
  
#Â ForÂ lightÂ terminals  
$Â nvitopÂ --light  
  
#Â ForÂ spectrum-likeÂ barÂ chartsÂ (requiresÂ theÂ terminalÂ supportsÂ 256-color)  
$Â nvitopÂ --colorful
```
  
  
### å°†ç›‘æ§ä¿¡æ¯å†™å…¥åˆ° TensorBoard ä¸­

```python
importÂ os  
  
importÂ torch  
importÂ torch.nnÂ asÂ nn  
importÂ torch.nn.functionalÂ asÂ F  
fromÂ torch.utils.tensorboardÂ importÂ SummaryWriter  
  
fromÂ nvitopÂ importÂ CudaDevice,Â ResourceMetricCollector  
fromÂ nvitop.callbacks.tensorboardÂ importÂ add_scalar_dict  
  
#Â BuildÂ networksÂ andÂ prepareÂ datasets  
...  
  
#Â LoggerÂ andÂ statusÂ collector  
writerÂ =Â SummaryWriter()  
collectorÂ =Â ResourceMetricCollector(devices=CudaDevice.all(),Â Â #Â logÂ allÂ visibleÂ CUDAÂ devicesÂ andÂ useÂ theÂ CUDAÂ ordinal  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â root_pids={os.getpid()},Â Â Â #Â onlyÂ logÂ theÂ descendantÂ processesÂ ofÂ theÂ currentÂ process  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â interval=1.0)Â Â Â Â Â Â Â Â Â Â Â Â Â Â #Â snapshotÂ intervalÂ forÂ backgroundÂ daemonÂ thread  
  
#Â StartÂ training  
global_stepÂ =Â 0  
forÂ epochÂ inÂ range(num_epoch):  
Â Â Â Â withÂ collector(tag='train'):  
Â Â Â Â Â Â Â Â forÂ batchÂ inÂ train_dataset:  
Â Â Â Â Â Â Â Â Â Â Â Â withÂ collector(tag='batch'):  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â metricsÂ =Â train(net,Â batch)  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â global_stepÂ +=Â 1  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â add_scalar_dict(writer,Â 'train',Â metrics,Â global_step=global_step)  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â add_scalar_dict(writer,Â 'resources',Â Â Â Â Â Â #Â tag='resources/train/batch/...'  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â collector.collect(),  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â global_step=global_step)  
  
Â Â Â Â Â Â Â Â add_scalar_dict(writer,Â 'resources',Â Â Â Â Â Â Â Â Â Â Â Â Â Â #Â tag='resources/train/...'  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â collector.collect(),  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â global_step=epoch)  
  
Â Â Â Â withÂ collector(tag='validate'):  
Â Â Â Â Â Â Â Â metricsÂ =Â validate(net,Â validation_dataset)  
Â Â Â Â Â Â Â Â add_scalar_dict(writer,Â 'validate',Â metrics,Â global_step=epoch)  
Â Â Â Â Â Â Â Â add_scalar_dict(writer,Â 'resources',Â Â Â Â Â Â Â Â Â Â Â Â Â Â #Â tag='resources/validate/...'  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â collector.collect(),  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â global_step=epoch)
```
  
  
### API ä½¿ç”¨æ‰‹å†Œ

**ã€Œè¯¦è§ã€** https://nvitop.readthedocs.io/


**ç›¸å…³ç¬”è®°:**

- [GPU å®æ—¶ç›‘æ§å·¥å…· nvtop](../77451a76ae1222084a1d5bf6efd199dc659c54c0)

{% pullquote mindmap mindmap-md %}
- ğŸ”µ
  - [GPU å®æ—¶ç›‘æ§å·¥å…· nvtop](../77451a76ae1222084a1d5bf6efd199dc659c54c0)
{% endpullquote %}