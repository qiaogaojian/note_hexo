---
title: humanoid-gym
date: 2024-10-23 11:06:49
categories: ['2.工作', '项目', '机器人', 'Project']
tags: ['项目', '机器人', 'Project', '工作']
---

Humanoid Gym 是具身智能机器人领域最广泛使用的训练框架, 基于 Isaac Gym 模拟器, 它的
  
  
## 基本信息

  
  
### github

[GitHub - roboterax/humanoid-gym: Humanoid-Gym: Reinforcement Learning for Humanoid Robot with Zero-Shot Sim2Real Transfer https://arxiv.org/abs/2404.05695](https://github.com/roboterax/humanoid-gym)
  
  
### 论文

[0.Humanoid-Gym Reinforcement Learning for Humanoid](../6f252f6a1db58de9aa515272f56dab6e4f95c489)
  
  
### 官网

[Humanoid-Gym](https://sites.google.com/view/humanoid-gym/)
  
  
## 开发环境

**前置:**
[[AI 模型训练开发环境]]

```sh
# 克隆项目到工程目录 /opt/git 
cd /opt/git  
git clone git@github.com:qiaogaojian/humanoid-gym.git
# 切换到自定义分支
git checkout -b real2sim2real

# 创建并激活虚拟环境
cd humanoid-gym
micromamba create -p ./venv python=3.8
micromamba activate ./venv

# 安装 pytorch
pip install torch==2.0.1+cu118 torchvision==0.15.2+cu118 torchaudio==2.0.2+cu118 torchtext==0.15.2 torchdata==0.6.1 --extra-index-url https://download.pytorch.org/whl/cu118 -i https://pypi.tuna.tsinghua.edu.cn/simple

# 安装 numpy
pip install numpy==1.21.1 -i https://pypi.tuna.tsinghua.edu.cn/simple

# 下载 Isaac Gym (humanoid gym 中已集成, 这一步可以跳过)
# 下载地址: https://developer.nvidia.com/isaac-gym
tar -xvf IsaacGym_Preview_4_Package.tar.gz
cd isaacgym/python && vim setup.py
# 因为前面已经安装过, 注释掉 torch>=1.8.0  和 torchvision>=0.9.0

# 安装 Isaac Gym
cd isaacgym/python && pip install -e . -i https://pypi.tuna.tsinghua.edu.cn/simple
# 测试 Isaac Gym 环境
cd examples && python 1080_balls_of_solitude.py

# 安装 Humanoid Gym
cd /opt/git/humanoid-gym && pip install -e . -i https://pypi.tuna.tsinghua.edu.cn/simple
```
  
  
## 操作命令

  
  
### 训练

Launching PPO Policy Training for 'v1' Across 4096 Environments
This command initiates the PPO algorithm-based training for the humanoid task.
```sh
python humanoid/scripts/train.py --task=humanoid_ppo --run_name v1 --num_envs 4096 --headless
```
  
  
### 测试

Evaluating the Trained PPO Policy 'v1'
This command loads the 'v1' policy for performance assessment in its environment. 
Additionally, it automatically exports a JIT model, suitable for deployment purposes.
```sh
python humanoid/scripts/play.py --task=humanoid_ppo --run_name v1 --num_envs 3 --load_run Oct23_14-56-23_v1
```
  
  
### sim2sim

Implementing Simulation-to-Simulation Model Transformation
This command facilitates a sim-to-sim transformation using exported 'v1' policy.
```sh
python humanoid/scripts/sim2sim.py --load_model logs/XBot_ppo/exported/policies/policy_1.pt
```

Run our trained policy
```sh
python humanoid/scripts/sim2sim.py --load_model logs/XBot_ppo/exported/policies/policy_example.pt
```
  
  
### real2sim


  
  
### sim2real


  
  
## 核心代码

```sh
humanoid/
├── algo/
│   ├── ppo/
│   │   ├── __init__.py         # PPO算法相关模块的初始化
│   │   ├── actor_critic.py     # 定义ActorCritic网络结构
│   │   ├── ppo.py              # PPO算法的核心实现
│   │   ├── on_policy_runner.py # 定义OnPolicyRunner类,管理训练过程
│   │   └── rollout_storage.py  # 定义RolloutStorage类,存储训练数据
│   ├── __init__.py             # algo模块的初始化文件
│   └── vec_env.py              # 定义VecEnv类,用于并行环境管理
├── envs/
│   ├── base/                   # base 环境
│   │   ├── legged_robot.py     # 定义LeggedRobot基类,实现基本的机器人环境
│   │   └── legged_robot_config.py # 定义LeggedRobotCfg和LeggedRobotCfgPPO配置类
│   └── humanoid/               # 这是具体的机器人训练环境, 每种机器人或训练算法都需要独立的环境
│       ├── humanoid_config.py  # 定义XBotLCfg和XBotLCfgPPO配置类 (环境配置和 PPO 算法配置)
│       └── humanoid_env.py     # 定义XBotLEnv类,实现人形机器人环境 (主要用于计算state reward)
├── scripts/                    # 功能脚本
│   ├── play.py                 # 用于运行训练好的策略
│   ├── sim2sim.py              # 实现从仿真到仿真的迁移
│   └── train.py                # 训练脚本的入口
├── utils/                      # 工具脚本
│   └── task_registry.py        # 定义TaskRegistry类,用于注册和管理任务
└── __init__.py                 # humanoid模块的初始化文件
```





**相关笔记:**

- [0.Humanoid-Gym Reinforcement Learning for Humanoid](../6f252f6a1db58de9aa515272f56dab6e4f95c489)

{% pullquote mindmap mindmap-md %}
- 🔵
  - [0.Humanoid-Gym Reinforcement Learning for Humanoid](../6f252f6a1db58de9aa515272f56dab6e4f95c489)
{% endpullquote %}