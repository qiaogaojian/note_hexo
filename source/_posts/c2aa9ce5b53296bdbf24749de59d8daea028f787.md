---
title: Python é¡¹ç›®ç®¡ç†æœ€ä½³å®è·µ Poetry
date: 2022-11-12 00:42:56
categories: ['5.æŠ€èƒ½', 'ç¼–ç¨‹è¯­è¨€', 'Python']
tags: ['srcard', 'python']
---

<mark style="background: #83d98fA6;">æœ€å¥½åªç”¨poetryæ¥è¿è¡Œpythonç¨‹åº, å®‰è£…ä½¿ç”¨ micromamba æˆ– pip, å¯¼å‡º environment.yaml æˆ– requirements.txt</mark> 
  
  
## ä¾èµ–ç®¡ç†

ä¾èµ–ç®¡ç†ä¸€ç›´éƒ½åœ¨ç¼–ç¨‹è¯­è¨€ä¸­å æ®ç€è‡³å…³é‡è¦çš„åœ°ä½ï¼Œæ— è®ºæ˜¯ Pythonã€JavaScript è¿˜æ˜¯ Javaã€Goã€‚

è™½ç„¶ä¸åŒç¼–ç¨‹è¯­è¨€çš„ä¾èµ–ç®¡ç†å·¥å…·ä¸å°½ç›¸åŒï¼Œä½†æ˜¯å®ƒä»¬è¿½æ±‚çš„ç›®æ ‡éƒ½æ˜¯å¤§åŒå°å¼‚çš„ã€‚èƒ½å¤Ÿå¯¹é¡¹ç›®ä»¥æ¥è¿›è¡Œæ›´åŠ è½»æ¾ç»Ÿä¸€çš„ç®¡ç†ï¼Œèƒ½å¤Ÿæ›´åŠ ä¾¿æ·çš„è¿›è¡Œé¡¹ç›®è¿ç§»å’Œéƒ¨ç½²ã€‚

å› æ­¤ï¼Œå°±å‡ºç°äº† mavenã€npmã€pip è¿™äº›ä¾èµ–åŒ…ç®¡ç†å·¥å…·ï¼Œä½†æ˜¯ï¼Œå¯¹æ¯”äº Java å’Œ JSï¼ŒPython åœ¨ä¾èµ–ç®¡ç†æ–¹é¢æ›´åŠ ç‰¹æ®Šã€‚æ‰€ä»¥ï¼Œå…ˆåå‡ºç°äº†å¤šæ¬¾ä¸åŒçš„ç®¡ç†å·¥å…·ï¼Œæ¯ä¸€æ¬¡å‡çº§éƒ½æ˜¯ä¸ºäº†æ›´å¥½çš„åšå¥½ Python çš„ä¾èµ–åŒ…ç®¡ç†å·¥å…·ã€‚
  
  
## Python çš„ç‰¹æ®Šæ€§

Python åœ¨ä¾èµ–åŒ…ç®¡ç†æ–¹é¢ä¸»è¦çš„ç‰¹æ®Šæ€§å°±æ¥è‡ªäºï¼Œä¸ä»…éœ€è¦è€ƒè™‘é¡¹ç›®ä»¥æ¥çš„ç¬¬ä¸‰æ–¹åŒ…ï¼Œè¿˜è¦ç€é‡è€ƒè™‘**è™šæ‹Ÿç¯å¢ƒ**ã€‚è¿™ä¸€ç‚¹ï¼Œæ˜¯ç”±äº Python å’Œ Javaã€JS è¿™äº›ç¼–ç¨‹è¯­è¨€æœ¬è´¨ä¸Šå­˜åœ¨å·®å¼‚å¯¼è‡´çš„ã€‚

Javaã€JS æ˜¯**ä»¥é¡¹ç›®è¿›è¡Œéš”ç¦»**ï¼Œæ¯å½“å¼€å‘ä¸€ä¸ªé¡¹ç›®ï¼Œä¾èµ–åŒ…éƒ½æ˜¯å®‰è£…åœ¨é¡¹ç›®å·¥ç¨‹è·¯å¾„ä¸‹ã€‚æ¯ä¸ªå·¥ç¨‹ä¹‹é—´æ˜¯éš”ç¦»çš„ï¼Œè¿™æ ·ï¼Œå³ä¾¿æ˜¯ä¸åŒå·¥ç¨‹ç”¨åˆ°åŒä¸€ä¸ªåŒ…çš„ä¸åŒç‰ˆæœ¬ï¼Œå®ƒä»¬ä¹‹é—´ä¹Ÿä¸ä¼šäº§ç”Ÿå†²çªã€‚

ä½†æ˜¯ï¼ŒPython åˆ™ä¸åŒï¼Œåœ¨ Python ä¸­æ— æ³•é€šè¿‡å·¥ç¨‹å¯¹ä¾èµ–åŒ…è¿›è¡Œéš”ç¦»ã€‚

å½“æˆ‘ä»¬ä¹‹é—´ä½¿ç”¨`pip`å®‰è£…ç¬¬ä¸‰æ–¹åŒ…æ—¶ï¼Œæ‰€æœ‰çš„ä¾èµ–éƒ½ä¼šå®‰è£…åˆ°å®‰è£…ç›®å½•ä¸‹çš„`site-packages`ã€‚

è¯•æƒ³ä¸€ä¸‹ï¼Œå¦‚æœæˆ‘ä»¬å¼€å‘ A å·¥ç¨‹ï¼Œç”¨åˆ°äº† TensorFlow`v0.1`ã€‚ä½†æ˜¯ï¼Œå¼€å‘ B å·¥ç¨‹ï¼Œéœ€è¦ç”¨åˆ° TensorFlow`v0.2`ã€‚è¿™æ—¶å€™ï¼Œsite-packages ä¸‹çš„ä¾èµ–åŒ…å°±ä¼šäº§ç”Ÿå†²çªï¼Œåé¢å®‰è£…çš„ä¾èµ–åŒ…å°±ä¼šæŠŠå‰é¢å·²ç»å®‰è£…çš„ç‰ˆæœ¬å¸è½½æ‰ç„¶åå†å®‰è£…æ–°ç‰ˆæœ¬ä¾èµ–åŒ…ã€‚

æ˜¾ç„¶ï¼Œè¿™æ ·æ˜¯éå¸¸ä¸å‹å¥½çš„ã€‚
  
  
## ç°æœ‰è™šæ‹Ÿç¯å¢ƒçš„å±€é™æ€§

ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œ**è™šæ‹Ÿç¯å¢ƒ**å°±èµ·åˆ°äº†è‡³å…³é‡è¦çš„ä½œç”¨ã€‚

åœ¨å¼€å‘ä¸åŒçš„å·¥ç¨‹æ—¶ï¼Œå¯ä»¥åˆ›å»ºå¹¶æ¿€æ´»ä¸åŒçš„è™šæ‹Ÿç¯å¢ƒã€‚è¿™æ ·ï¼Œä¸åŒçš„å·¥ç¨‹å°±ä¼šç”¨åˆ°ä¸åŒç¯å¢ƒä¸‹çš„è§£æå™¨ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æŠŠä¾èµ–åŒ…å®‰è£…åˆ°ä¸åŒè™šæ‹Ÿç¯å¢ƒçš„ site-packages è·¯å¾„ä¸‹ã€‚

å› æ­¤ï¼Œåœ¨ Python ä¸­ä¾èµ–ç®¡ç†ä¸€èˆ¬æŒ‡ä»£**ä¾èµ–ç®¡ç† + è™šæ‹Ÿç¯å¢ƒ**ã€‚
  
  
### virtualenv çš„å±€é™æ€§

ä»¥å¾€ï¼Œé’ˆå¯¹ Python ä¾èµ–ç®¡ç†å’Œè™šæ‹Ÿç¯å¢ƒç»å¸¸ä¼šç”¨åˆ° 2 ä¸ªå·¥å…·ï¼š`pip`å’Œ`virtualenv`ã€‚

å…¶ä¸­ pip ç”¨äºä¾èµ–åŒ…çš„ç®¡ç†ï¼Œvirtualenv ç”¨äºè™šæ‹Ÿç¯å¢ƒçš„ç®¡ç†ã€‚

è¿™æ ·è™½ç„¶è§£å†³äº†ä¸åŒå·¥ç¨‹ä¹‹é—´ç¯å¢ƒéš”ç¦»çš„é—®é¢˜ï¼Œä½†æ˜¯ä¹Ÿå­˜åœ¨ç€æ˜æ˜¾çš„ä¸è¶³ï¼š

*   éœ€è¦åŒæ—¶ä¾èµ– 2 æ¬¾ç®¡ç†å·¥å…·    
*   ä¸èƒ½åŠ¨æ€æ›´æ–° requirements.txt    

å…¶ä¸­æ¯”è¾ƒçªå‡ºçš„é—®é¢˜å°±æ˜¯ç¬¬ 2 ç‚¹ã€‚

åœ¨å·¥ç¨‹å¼€å‘è¿‡ç¨‹ä¸­ï¼Œéœ€è¦ä¸€ä¸ªé…ç½®æ–‡ä»¶æ¥è®°å½•ä¾èµ–åŒ…å’Œç¯å¢ƒå‚æ•°ï¼Œä¾‹å¦‚ï¼Œmaven çš„ pom.xmlã€npm çš„ package.jsonã€‚

è€Œåœ¨ Python ä¸­å¸¸ç”¨çš„å°±æ˜¯ requirements.txtã€‚

è¿™ç§çº¯æ–‡æœ¬çš„æ ¼å¼åªèƒ½ç”¨äºè®°å½•ä¾èµ–åŒ…çš„åç§°ï¼Œè€Œä¸èƒ½åƒ yamlã€jsonã€xml è¿™äº›æ–‡æœ¬å­˜å‚¨æ ¼å¼ä¸€æ ·è®°å½•æ›´å¤šç¯å¢ƒå‚æ•°ä¿¡æ¯ã€‚

å¦å¤–ï¼Œæ›´è‡´å‘½çš„ä¸€ç‚¹å°±æ˜¯ï¼Œæ¯æ¬¡å¯¼å‡ºä¾èµ–åŒ…éƒ½éœ€è¦æ‰‹åŠ¨æ‰§è¡Œ`pip freeze > requirements.txt`å‘½ä»¤ã€‚å¾ˆæ˜æ˜¾ï¼Œè¿™æ ·æ˜¯éå¸¸ä¸åˆç†çš„ã€‚è¯•æƒ³ä¸€ä¸‹ï¼Œå¦‚æœç”±äºå¿™ç¢Œå¿˜è®°æ‰‹åŠ¨æ‰§è¡Œè¿™é¡¹æ“ä½œï¼Œé‚£ä¹ˆè´¹ä¹ç‰›äºŒè™ä¹‹åŠ›éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒä¹‹åå‘ç°æŠ¥é”™ï¼Œè¿™æ ·ä¼šé€ æˆå¾ˆå¤§çš„æŸå¤±ã€‚

å› æ­¤ï¼Œ`pipenv`å°±è¯ç”Ÿäº†ã€‚
  
  
### pipenv çš„å±€é™æ€§

pipenv æ˜¯ç”± requestsã€flask ç­‰çŸ¥åå·¥å…·åŒ…çš„ä½œè€… Kenneth Reitz äº 2017 å¹´å‘å¸ƒçš„ä¸€æ¬¾ Python ä¾èµ–åŒ…ç®¡ç†å·¥å…·ã€‚

pipenv å¯ä»¥çœ‹æˆæ˜¯ pip+virtualenv ä¸¤æ¬¾å·¥å…·çš„åˆä½“ï¼Œå®ƒé›†åˆäº† pip çš„ä¾èµ–åŒ…ç®¡ç†å’Œ virtualenv è™šæ‹Ÿç¯å¢ƒç®¡ç†äºä¸€èº«ã€‚å¦å¤–ï¼Œåœ¨ä¾èµ–åŒ…è®°å½•æ–¹é¢ä½¿ç”¨ Pipfile æ›¿ä»£åŸæ¥çš„ requirements.txtã€‚è€Œä¸”ï¼Œå®ƒèƒ½å¤Ÿè‡ªåŠ¨è®°å½•å¹¶æ›´æ–°è®°å½•æ–‡ä»¶ï¼Œè¿™æ ·å°±ä¸å†éœ€è¦æ‰‹åŠ¨æ‰§è¡Œå‘½ä»¤æ¥æ›´æ–° requirements.txtã€‚

pipenv çš„å‡ºç°çš„ç¡®å¤§å¤§é™ä½äº† Python ä¾èµ–åŒ…ç®¡ç†çš„å¤æ‚åº¦ï¼Œæå‡äº†é¡¹ç›®å¼€å‘ã€å·¥ç¨‹è¿ç§»çš„æ•ˆç‡ã€‚

å› æ­¤ï¼Œè¿‘å‡ å¹´å…³äº pipenv çš„è¯„ä»·ä¸€ç›´éƒ½éå¸¸å¥½ï¼Œå„å¤§å†…å®¹å¹³å°å¯¹äº pipenv ç§°é¢‚çš„æ–‡ç« æ›´æ˜¯**å¤šå¦‚ç‰›æ¯›**ã€‚

ä½†æ˜¯ï¼Œæˆ‘è‡³ä»Šæ²¡æœ‰æˆä¸º pipenv çš„å¿ å®ç”¨æˆ·ï¼Œè€Œä¸”ï¼Œä¹Ÿä¸ä¼šé€‰æ‹© pipenv æ¥ä»£æ›¿åŸæ¥ pip+virtualenv çš„æ–¹æ¡ˆã€‚

æˆ‘ç›¸ä¿¡ï¼Œé‚£äº›æ»¡ç¯‡ç§°é¢‚ pipenv çš„ä½œè€…ä¹Ÿæœªå¿…æ˜¯å®ƒçš„å¿ å®ç”¨æˆ·ã€‚

ä¸å¯å¦è®¤ï¼Œpipenv åœ¨ Python ä¾èµ–åŒ…ç®¡ç†æ–¹é¢æä¾›äº†ä¸€ä¸ªå¾ˆå¥½çš„è§£å†³æ–¹æ¡ˆã€‚ä½†æ˜¯ï¼Œå®ƒä¾ç„¶æœ‰ä¸€äº›è‡´å‘½çš„ç¼ºé™·ï¼Œæ¯”åŸæ¥ pip+virtualenv æ–¹æ¡ˆçš„ç¹çã€æ‰‹åŠ¨æ“ä½œæ›´ä¸ºæ£˜æ‰‹ã€‚

*   Lock é€Ÿåº¦ç¼“æ…¢    
*   å¼ºè¡Œæ›´æ–°ä¸ç›¸å¹²ä¾èµ–    
*   ä¾èµ–å¤„ç†æ•ˆæœè¾ƒå·®    

è¿™é‡Œä¸¾ä¸ªä¾‹å­æ¥è§£é‡Šä¸€ä¸‹ç¬¬ 3 ç‚¹ã€‚

ä½¿ç”¨ pipenv å®‰è£…ä¸€ä¸ªåŒ…ï¼Œ

```sh
$Â pipenvÂ installÂ oslo.utils==1.4.0
```

è¿™æ—¶å€™å°±ä¼šå‘ç”ŸæŠ¥é”™ï¼Œ

```sh
CouldÂ notÂ findÂ aÂ versionÂ thatÂ matchesÂ pbr!=0.7,!=2.1.0,<1.0,>=0.6,>=2.0.0
```

è¿™ä¸ªæŠ¥é”™çš„å«ä¹‰æ˜¯æ— æ³•æ‰¾åˆ°åˆé€‚ç‰ˆæœ¬çš„ pbrï¼Œå³ä¾¿æ˜¯æœ‰åˆé€‚çš„ç‰ˆæœ¬ï¼Œpipenv ä¹Ÿä¼šç®€å•ç²—æš´çš„æŠ›å‡ºé”™è¯¯ï¼Œæ— æ³•å®Œæˆä¾èµ–åŒ…çš„å¤„ç†å’Œå®‰è£…ã€‚

è¿™æ—¶ï¼Œæ›´ä¸ºä¼˜ç§€çš„å·¥å…·åŒ…å‡ºç°äº†ï¼Œå®ƒå°±æ˜¯ **poetry**ã€‚
  
  
## ä¾èµ–ç®¡ç†çš„æœ€ä½³å®è·µ poetry

  
  
### ä»€ä¹ˆæ˜¯ poetry

  
poetry æ˜¯ä¸€æ¬¾å¯ä»¥ç®¡ç† Python ä¾èµ–ã€ç¯å¢ƒï¼ŒåŒæ—¶å¯ä»¥ç”¨äº Python å·¥ç¨‹æ‰“åŒ…å’Œå‘å¸ƒçš„ä¸€æ¬¾ç¬¬ä¸‰æ–¹å·¥å…·åŒ…ã€‚
  
poetry é€šè¿‡é…ç½®æ–‡ä»¶`pyproject.toml`æ¥å®Œæˆä¾èµ–ç®¡ç†ã€ç¯å¢ƒé…ç½®ã€åŸºæœ¬ä¿¡æ¯é…ç½®ç­‰åŠŸèƒ½ã€‚ç›¸å½“äºæŠŠ Python é¡¹ç›®ä¸­çš„`Pipfile`ã€`setup.py`ã€`setup.cfg`ã€`requirements.txt`ã€`MANIFEST.in`èåˆåˆ°ä¸€èµ·ã€‚
  
é€šè¿‡`pyproject.toml`æ–‡ä»¶ï¼Œä¸ä»…å¯ä»¥é…ç½®ä¾èµ–åŒ…ï¼Œè¿˜å¯ä»¥ç”¨äºåŒºåˆ†å¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ç¯å¢ƒã€é…ç½®æºè·¯å¾„ã€‚
<!--SR:!2026-11-09,1000,270-->
  
  
### ä¸ºä»€ä¹ˆé€‰æ‹© poetry

  
poetry ç›¸æ¯”äº pipenv å…·æœ‰å¾ˆå¤šæ˜æ˜¾ä¼˜åŠ¿çš„åŠŸèƒ½ï¼š
  
*   æ›´å¼ºå¤§çš„ä¾èµ–å¤„ç†åŠŸèƒ½    
*   æ˜“äºæ‰“åŒ…å’Œæ„å»º Python å·¥ç¨‹    
*   æ˜“äºå‘å¸ƒå·¥å…·åŒ…    
*   ç»“æ„åŒ–å±•ç¤ºä¾èµ–å…³ç³»    
<!--SR:!2025-01-20,506,250-->

**1. æ›´å¼ºå¤§çš„ä¾èµ–å¤„ç†åŠŸèƒ½**

ä»¥å‰é¢ä»‹ç» pipenv çš„ä¾‹å­æ¥ä»‹ç» poetry åœ¨ä¾èµ–å¤„ç†æ–¹é¢çš„å¼ºå¤§ä¹‹å¤„ã€‚

pipenv åœ¨å®‰è£…å·¥å…·åŒ…é‡åˆ°ç›´è§‚çš„é—®é¢˜æ—¶ä¼šç›´æ¥æŠ¥é”™ï¼Œå¹¶ç»ˆæ­¢ã€‚

è€Œä½¿ç”¨ poetry å®‰è£…åˆ™ä¸ä¼šï¼Œ

```sh
$Â poetryÂ addÂ oslo.utils=1.4.0Â Â 
-Â InstallingÂ pytzÂ (2018.3)Â Â 
-Â InstallingÂ netifacesÂ (0.10.6)Â Â -Â InstallingÂ netaddrÂ (0.7.19)Â Â -Â InstallingÂ oslo.i18nÂ (2.1.0)Â Â -Â InstallingÂ iso8601Â (0.1.12)Â Â -Â InstallingÂ sixÂ (1.11.0)Â Â -Â InstallingÂ babelÂ (2.5.3)Â Â -Â InstallingÂ pbrÂ (0.11.1)Â Â -Â InstallingÂ oslo.utilsÂ (1.4.0)
```

poetry åœ¨é‡åˆ°`pbr (>=0.6,!=0.7,<1.0)`è¿™ä¸ªé™å®šæ¡ä»¶æ—¶ï¼Œå®ƒä¼šå°è¯•å»å®‰è£…æœ€æ–°çš„ pbr(0.11.1 ç‰ˆ)ï¼ŒåŒæ—¶ä¼šé€‰æ‹©`oslo.i18n==3.20.0`ï¼Œä½†æ˜¯ï¼Œè¿™æ—¶å€™å‘ç°`oslo.i18n`çš„ç‰ˆæœ¬å’Œ pbr æœ€æ–°ç‰ˆæœ¬å†²çªã€‚å¦‚æœåœ¨ pipenv ä¸­åˆ™ä¼šæŠ¥é”™ã€‚ä½†æ˜¯ poetry ä¼šå°è¯•æ‰¾å‡ºè§£å†³æ–¹æ¡ˆï¼Œæœ€åå‘ç°`oslo.i18n==2.1.0`æ—¶å¯ä»¥æ»¡è¶³æ‰€æœ‰ç›¸äº’ä¾èµ–å…³ç³»çš„è¦æ±‚ã€‚æœ€ç»ˆï¼ŒæˆåŠŸå®‰è£…ä¾èµ–åŒ…ã€‚
<!--SR:!2024-10-22,440,250-->

**2. æ˜“äºæ‰“åŒ…å’Œæ„å»º Python å·¥ç¨‹**

åœ¨å·¥ç¨‹å¼€å‘è¿‡ç¨‹ä¸­ï¼Œé¡¹ç›®è¿ç§»å’Œå·¥ç¨‹åŒ–éƒ¨ç½²æ˜¯æ— æ³•ç»•å¼€çš„é—®é¢˜ã€‚

å¦‚æœéœ€è¦æŠŠæˆ‘ä»¬çš„å·¥ç¨‹éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒæœåŠ¡å™¨ä¸Šï¼Œè¿™æ—¶å€™å°±éœ€è¦ç”¨åˆ° Python çš„æ‰“åŒ…å’Œå®‰è£…åŠŸèƒ½ã€‚

åœ¨ä»¥å¾€ï¼Œä¼šå†™ç¹ççš„`setup.py`ã€`setup.cfg`ã€‚è€Œåœ¨ poetry ä¸­ï¼Œä¸€è¡Œå‘½ä»¤å°±å¯ä»¥è§£å†³ï¼Œ

```sh
$Â poetryÂ build 
BuildingÂ poetryÂ (1.0.0)-Â BuildingÂ sdist-Â BuiltÂ poetry-1.0.0.tar.gz-Â BuildingÂ wheel-Â BuiltÂ poetry-1.0.0-py2.py3-none-any.whl
```

**3. æ˜“äºå‘å¸ƒå·¥å…·åŒ…**

å¦‚æœæƒ³è¦æŠŠå·¥ç¨‹å‘å¸ƒåˆ° PyPI ä»“åº“æ€ä¹ˆåŠï¼Ÿ

åœ¨ poetry ä¸­ï¼Œåªéœ€è¦ç®€å•é…ç½®ä¸€ä¸‹`pyproject.toml`ï¼Œå°±å¯ä»¥å®ç°ä¸€è¡Œå‘½ä»¤å‘å¸ƒå·¥å…·åŒ…ï¼Œ

```sh
$Â poetryÂ publish
PublishingÂ poetryÂ (1.0.0)Â toÂ PyPIÂ Â -Â UploadingÂ poetry-1.0.0.tar.gzÂ 100%Â Â -Â UploadingÂ poetry-1.0.0-py2.py3-none-any.whlÂ 58%
```

**ç»“æ„åŒ–å±•ç¤ºä¾èµ–å…³ç³»**

Python æ˜¯ä¸€æ¬¾å¯¹ç¬¬ä¸‰æ–¹å·¥å…·åŒ…ä¾èµ–å¾ˆå¼ºçš„ä¸€ç§ç¼–ç¨‹è¯­è¨€ï¼Œä¸€ä¸ªé¡¹ç›®ä¸­ä¼šç”¨åˆ°å¾ˆå¤šæ¬¾ä¸åŒçš„å·¥å…·åŒ…ï¼Œè€Œè¿™äº›åŒ…çš„ä¾èµ–å…³ç³»æ˜¯ä»€ä¹ˆæ ·çš„ï¼Œå¾ˆå¤šå¼€å‘è€…å¯¹å…¶äº†è§£å´å¾ˆå°‘ã€‚

poetry å¯ä»¥å®ç°ç»“æ„åŒ–å±•ç¤ºæ¯ä¸ªå·¥å…·åŒ…çš„ä¾èµ–å…³ç³»ï¼Œè®©å·¥ç¨‹çš„ä¾èµ–ä¸€ç›®äº†ç„¶ï¼Œ

```sh
$Â poetryÂ showÂ --treerequests-toolbeltÂ 0.8.0Â AÂ utilityÂ beltÂ forÂ advancedÂ users...
â””â”€â”€Â requestsÂ <3.0.0,>=2.0.1Â Â Â Â 
â”œâ”€â”€Â certifiÂ >=2017.4.17Â Â Â Â 
â”œâ”€â”€Â chardetÂ >=3.0.2,<3.1.0Â Â Â Â 
â”œâ”€â”€Â idnaÂ >=2.5,<2.7Â Â Â Â 
â””â”€â”€Â urllib3Â <1.23,>=1.21.1

$Â poetryÂ showÂ --latestpendulumÂ 2.0.4Â Â Â 1.4.5Â PythonÂ datetimesÂ madeÂ easy.djangoÂ Â Â 1.11.11Â 2.0.3Â AÂ high-levelÂ PythonÂ WebÂ frameworkÂ ...requestsÂ 2.18.4Â Â 2.18.4Â PythonÂ HTTPÂ forÂ Humans.
```
  
  
### Micromamba Poetry å®‰è£…è„šæœ¬[^4]

```sh
 # å®‰è£… micromamba å’Œ poetry
if command -v micromamba &>/dev/null; then
    echo "micromamba is already installed."
    eval "$(/usr/local/bin/micromamba shell hook -s posix)"
else
    echo "micromamba is installing..."
    mkdir -p /usr/local/bin
    curl -Ls https://micro.mamba.pm/api/micromamba/linux-64/latest | tar -xvj -C /usr/local bin/micromamba 
    eval "$(/usr/local/bin/micromamba shell hook -s posix)"
    /usr/local/bin/micromamba shell init -s bash -p ~/micromamba  # this writes to your .bashrc file
    source ~/.bashrc
    cat > ~/.condarc <<EOF
channels: 
  - defaults
show_channel_urls: true
default_channels:
  - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
  - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/r
  - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/msys2
custom_channels:
  conda-forge: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud
  msys2: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud
  bioconda: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud
  menpo: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud
  pytorch: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud
  pytorch-lts: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud
  simpleitk: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud
  deepmodeling: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/
EOF
    micromamba config append channels conda-forge        
fi
    
micromamba create -p ./venv python=3.9 -y
micromamba activate ./venv
micromamba run -p ./venv python -m pip install poetry==1.7.0 -i https://pypi.tuna.tsinghua.edu.cn/simple

```


  
  
### Poetry å®‰è£…å’Œåˆå§‹åŒ– [^1]

  
  
##### poetry å®‰è£… 

```bash
# ********************************* Linux, macOS *********************************
$ curl -sSL https://install.python-poetry.org | python3 -

# å®‰è£…ç‰¹å®šç‰ˆæœ¬ poetry
$ curl -sSL https://install.python-poetry.org | POETRY_VERSION=1.1.2 python3 -

# ********************************* Windows (Powershell) *********************************
# If you have installed Python through the Microsoft Store, replaceÂ `py`Â withÂ `python`Â in the command below.
$ (Invoke-WebRequest -Uri https://install.python-poetry.org -UseBasicParsing).Content | py -  

```
  
  
##### poetry ç¯å¢ƒå˜é‡

  
è¿™é‡Œé…ç½®çš„ç¯å¢ƒå˜é‡å¯¹äºé€šè¿‡sshpassæ‰§è¡Œçš„å‘½ä»¤æ— æ•ˆï¼Œå¦‚æœéœ€è¦å…¨å±€å˜é‡ï¼Œå¯å‚è€ƒï¼š[_Linux å¸¸ç”¨å‘½ä»¤#ç¯å¢ƒå˜é‡](../06ebd355770738c865ee28ef13d2206bbfb36692/#ç¯å¢ƒå˜é‡)
```sh
# ********************************* Linux, macOS *********************************
$ sudo su

$ vim ~/.bashrc
# æ·»åŠ ä»¥ä¸‹ç¯å¢ƒå˜é‡
export PATH="/root/.local/bin:$PATH"
export PYTHON_KEYRING_BACKEND=keyring.backends.null.Keyring

$ source ~/.bashrc

# sshpass è¿œç¨‹æ‰§è¡Œæ—¶éœ€è¦è®¾ç½®è½¯é“¾æ¥, æ·»åŠ sshpassç¼ºå°‘çš„ç¯å¢ƒå˜é‡
$ ln -s /root/.local/bin/poetry poetry

# ********************************* Windows *********************************
%APPDATA%\Python\Scripts
```
  
The installer creates aÂ `poetry`Â wrapper in a well-known, platform-specific directory:
  
-   `$HOME/.local/bin`Â on Unix.
-   `%APPDATA%\Python\Scripts`Â on Windows.
-   `$POETRY_HOME/bin`Â ifÂ `$POETRY_HOME`Â is set.

If this directory is not present in yourÂ `$PATH`, you can add it in order to invoke Poetry asÂ `poetry`.
Alternatively, the full path to theÂ `poetry`Â binary can always be used:
  
-   `~/.local/share/pypoetry/venv/bin/poetry`Â on Linux/Unix.
-   `%APPDATA%\pypoetry\venv\Scripts\poetry`Â on Windows.
-   `~/Library/Application Support/pypoetry/venv/bin/poetry`Â on MacOS.
-   `$POETRY_HOME/venv/bin/poetry`Â ifÂ `$POETRY_HOME`Â is set.
  
  
#####  poetry é…ç½® venv åˆ°é¡¹ç›®æ–‡ä»¶å¤¹

```sh
$ poetry config virtualenvs.create true
$ poetry config virtualenvs.in-project true
```
<!--SR:!2024-07-02,212,249-->

**fish é…ç½®**

[Fish æ·»åŠ  PATH è·¯å¾„(ç¯å¢ƒå˜é‡)](../e13093cac8ccdc5b3204f4d66ee9a7db927ce606)

**poetry å·¥ç¨‹åˆå§‹åŒ–**
  
å¦‚æœå½“å‰è¿˜æ²¡æœ‰åˆ›å»ºå·¥ç¨‹ï¼Œå¯ä»¥ä½¿ç”¨ poetry æ–°å»ºå·¥ç¨‹ï¼š
  
```sh
$Â poetryÂ newÂ poetry-demo
```
  
è¿™æ—¶å€™ï¼Œä¼šåˆ›å»ºä¸€ä¸ªåŒ…å«å¦‚ä¸‹å†…å®¹çš„å·¥ç¨‹ï¼Œ
  
```sh
poetry-demo
â”œâ”€â”€Â pyproject.toml
â”œâ”€â”€Â README.rst
â”œâ”€â”€Â poetry_demo
â”‚Â Â Â â””â”€â”€Â __init__.py
â””â”€â”€Â tests
Â Â Â Â â”œâ”€â”€Â __init__.py
Â Â Â Â â””â”€â”€Â test_poetry_demo.py
```
  
é™¤äº†æ–°å»ºå·¥ç¨‹ï¼Œè¿˜å¯ä»¥åœ¨å·²æœ‰å·¥ç¨‹çš„åŸºç¡€ä¸Šè¿›è¡Œåˆ›å»ºï¼Œ
  
```sh
$Â poetryÂ init
```
  
è¿™æ—¶å€™ï¼Œå®ƒä¼šè®©ä½ è¾“å…¥åŒ…åç§°ã€ç‰ˆæœ¬å·ç­‰ä¿¡æ¯ï¼Œä½ å¯ä»¥é€‰æ‹©è¾“å…¥ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©æŒ‰ä¸‹`ENTER`é”®ä½¿ç”¨é»˜è®¤å€¼ã€‚
<!--SR:!2024-09-30,424,250-->
  
  
#### poetry æ›´æ¢å›½å†…é•œåƒæº

åœ¨ pyproject.toml é…ç½®æ–‡ä»¶ä¸­æœ€ä¸‹æ–¹æ·»åŠ å›½å†…é•œåƒæºåœ°å€é…ç½®, æé«˜ä¸‹è½½é€Ÿåº¦ã€‚
  
```toml
[[tool.poetry.source]]  
name = "aliyun"  
url = "http://mirrors.aliyun.com/pypi/simple"  
default = true
```
  
  
#### poetry è¿è¡Œ Python è„šæœ¬

  
åˆ‡æ¢åˆ°é¡¹ç›®ä¸­ pyproject.toml åŒçº§ç›®å½•ä¸‹ï¼Œ æ‰§è¡Œ peotry run python è„šæœ¬æ–‡ä»¶å³å¯ã€‚(ä»£ç importè·¯å¾„è¦ä»é¡¹ç›®æ ¹ç›®å½•å¼€å§‹)
<!--SR:!2026-04-04,753,250-->

**Pycharm ä¸­ä½¿ç”¨Â poetry**
  
![](/images/Pasted image 20230509162121.png)
æ‰“å¼€é¡¹ç›®çš„ç»ˆç«¯å¹¶è¿è¡ŒÂ `poetry env info`Â å‘½ä»¤ï¼Œæ‰¾åˆ°é¡¹ç›®å¯¹åº”çš„è™šæ‹Ÿç¯å¢ƒæ–‡ä»¶å¤¹æ‰€åœ¨ä½ç½®(`Executable å­—æ®µ`)ï¼ŒæŒ‰ç…§ä¸‹å›¾æ­¥éª¤æ‰“å¼€å¹¶é€‰ä¸­ Scripts ç›®å½•ä¸‹çš„ Python åï¼Œå°±å¯ä»¥ç”¨ Pycharm å¼•å…¥è™šæ‹Ÿç¯å¢ƒäº†
![](/images/Pasted image 20221027182115.png)
<!--SR:!2025-05-01,443,250-->
  
  
### poetry ä¾èµ–åŒ…ç®¡ç†

- **æœ¬åœ°ä»£ç ä¾èµ–**
  
ä¾èµ–å½“å‰å·¥ç¨‹ç›®å½•çš„ package
```yml
[tool.poetry]  
...
packages = [{include = "common"},{include = "core"}]
```
ä¾èµ–å…¶ä»–å·¥ç¨‹ç›®å½•çš„ package
```yml
[tool.poetry]
...
packages = [
    {include = "src", from="D:/git/Tweaks/tweaks_python"},
    {include = "core", from="D:/git/Tweaks/tweaks_python/src"},
    {include = "common", from="D:/git/Tweaks/tweaks_python/src"}
]
```
é…ç½®å®Œåéœ€è¦æ‰§è¡Œå‘½ä»¤: `poetry install`
è·¯å¾„æ— æ•ˆä¼šæŠ¥ä¸‹é¢çš„é”™è¯¯:
```sh
$ poetry install
Installing dependencies from lock file
Warning: poetry.lock is not consistent with pyproject.toml. You may be getting improper dependencies. Run `poetry lock [--no-update]` to fix it.
```
<!--SR:!2025-03-16,372,230-->


*   **å®‰è£…ä¾èµ–åŒ…**    
  
å¯ä»¥ä½¿ç”¨ add å‘½ä»¤æ¥å®‰è£…ä¸€æ¬¾ Python å·¥å…·åŒ…ï¼Œ
  
```sh
$Â poetryÂ addÂ numpy
```
  
è¿˜å¯ä»¥ï¼Œé€šè¿‡æ·»åŠ é…ç½®å‚æ•°`--dev`æ¥åŒºåˆ†ä¸åŒç¯å¢ƒä¸‹çš„ä¾èµ–åŒ…ã€‚
  
å¯ä»¥ä½¿ç”¨ install å‘½ä»¤ç›´æ¥è§£æå¹¶å®‰è£…`pyproject.toml`çš„ä¾èµ–åŒ…ï¼Œ
  
```sh
$Â poetryÂ install
```
<!--SR:!2026-08-18,836,250-->

- **ä»è¿œç¨‹ä»“åº“å®‰è£…ä¾èµ–**[^5] [^6]
  
```sh
# poetry add git+<protocol>://git@<repository>/<owner>/<project>.git#<git_ref>
poetry add git+ssh://git@gitlab.blabla.co/nubela/project-a.git
poetry add git+https://git@github.com/agn-7/sqladmin.git
```
<!--SR:!2024-10-21,150,250-->

- **ä» requirements.txt æ–‡ä»¶ä¸­å®‰è£…ä¾èµ–** [^2]
  
```python
cat requirements.txt | xargs poetry add
```
<!--SR:!2024-09-01,185,249-->

- **ä» github ç§æœ‰åº“å®‰è£…ä¾èµ–åŒ…**[^3]
  
```sh
$ poetry add git+ssh://git@github.com/qiaogaojian/pycore.git
$ pip install git+ssh://git@github.com/qiaogaojian/pycore.git --upgrade
```
<!--SR:!2024-09-04,186,249-->

*   **æ›´æ–°ä¾èµ–åŒ…**
  
æ›´æ–°æ‰€æœ‰é”å®šç‰ˆæœ¬çš„ä¾èµ–åŒ…ï¼Œ
  
```sh
$Â poetryÂ update
```
  
æ›´æ–°æŒ‡å®šä¾èµ–åŒ…ï¼Œ
  
```sh
$Â poetryÂ updateÂ numpy
```

*   **å¸è½½ä¾èµ–åŒ…**
  
```sh
$Â poetryÂ removeÂ numpy
```
<!--SR:!2025-01-10,497,250-->

- **æŸ¥çœ‹ä¾èµ–æ ‘**
  
```sh
$ poetry show --tree
```
<!--SR:!2024-08-29,242,249-->
  
  
### poetry è™šæ‹Ÿç¯å¢ƒç®¡ç†

*   **æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ** 
  
```sh
$Â poetryÂ shell
```
<!--SR:!2024-09-28,423,250-->

*   **æŸ¥çœ‹è™šæ‹Ÿç¯å¢ƒä¿¡æ¯** 
  
```sh
$Â poetryÂ envÂ info
```
<!--SR:!2025-01-24,509,250-->

*   **æ˜¾ç¤ºè™šæ‹Ÿç¯å¢ƒåˆ—è¡¨** 
  
```sh
$Â poetryÂ envÂ list
```
<!--SR:!2025-09-30,640,250-->

*   **åˆ é™¤è™šæ‹Ÿç¯å¢ƒ**    

```sh
$Â poetryÂ envÂ removeÂ python3.7
```
<!--SR:!2024-02-14,284,250-->

**Poetry å¸¸ç”¨å‘½ä»¤è¡Œç•Œé¢ (CLI) å‘½ä»¤**
  
![](/images/v2-97299659f5761d6e00d72b0529b14dab_b.jpg)
<!--SR:!2026-02-07,717,250-->
  
  
## é›†æˆåˆ° Obsidian

1. å®‰è£…æ’ä»¶ [GitHub - twibiral/obsidian-execute-code: Obsidian Plugin to execute code in a note.](https://github.com/twibiral/obsidian-execute-code)
2. é…ç½®æ’ä»¶
![](/images/Pasted image 20221203204432.png)
3. æ‰“å¼€ç›®å½• `%LocalAppData%/Obsidian` æ–°å»º pyproject.toml
4. poetry é¡¹ç›®é…ç½®
```toml
[tool.poetry]
name = "obsidian"
version = "0.1.0"
description = "obsidian dependencies"
authors = ["bs2h <bs2h@xxx.com>"]
packages = [
    {include = "src", from="D:/git/Tweaks/tweaks_python"},
    {include = "core", from="D:/git/Tweaks/tweaks_python/src"},
    {include = "common", from="D:/git/Tweaks/tweaks_python/src"}
]

[tool.poetry.dependencies]
python = "^3.9"
hexbytes = "^0.2.2"
environs = "^9.5.0"
PyMySQL = "^1.0.2"
redis = "^4.1.4"
pymongo = "^4.3.2"
web3 = "5.13.1"
bloxroute-cli = "^1.109.9"
kafka-python = "^2.0.2"
flask = "^2.2.2"
matplotlib = "^3.6.0"
seaborn = "^0.12.1"

[tool.poetry.dev-dependencies]

[build-system]
requires = ["poetry-core>=1.0.0"]
build-backend = "poetry.core.masonry.api"

# è®¾ç½®å›½å†…æº
[[tool.poetry.source]]
name = "aliyun"
url = "http://mirrors.aliyun.com/pypi/simple"
default = true
```
5. æµ‹è¯•ä»£ç 
```python
from core.time_class import Time
from core.base_class import Core

if __name__ == "__main__":  
    core = Core()  
    core.init("dev")  
    logger = core.logger

    cur_time_str = Time.get_cur_timestr()  
    logger.info(f"local timestr: {cur_time_str}")

```
  
  
## å¼•ç”¨

[^1]:[Poetry - Python dependency management and packaging made easy](https://python-poetry.org/docs/#installing-with-the-official-installer)
[^2]:[python - How to import requirements.txt from an existing project using Poetry - Stack Overflow](https://stackoverflow.com/questions/62764148/how-to-import-requirements-txt-from-an-existing-project-using-poetry)

[pipx: Install and Run Python Applications in Isolated Environments](https://github.com/pypa/pipx)
[Failed to create the collection when try adding any dependencies Â· Issue #6719 Â· python-poetry/poetry Â· GitHub](https://github.com/python-poetry/poetry/issues/6719)
[Keyring errors during non-publishing operations Â· Issue #1917 Â· python-poetry/poetry Â· GitHub](https://github.com/python-poetry/poetry/issues/1917)
[python - pyvenv not working because ensurepip is not available - Stack Overflow](https://stackoverflow.com/questions/39539110/pyvenv-not-working-because-ensurepip-is-not-available)
[Python Micromamba + Poetry ç¯å¢ƒç®¡ç†](../2b9c7abe1d255b7d5bce4c9b3e11ee7195afffb4)
[Poetry add æŠ¥é”™ xxx not found in known hashes](../8efeac92a7aadd61a7f9c1413a43c9943393b97e)
[æœ€ä½³ Python å¥—ä»¶ç®¡ç†å™¨â€”â€”Poetry å®Œå…¨å…¥é–€æŒ‡å— - Code and Me](https://blog.kyomind.tw/python-poetry/)
[^3]: [Fetching Title#z5uq](https://blog.csdn.net/qq_40851623/article/details/118190014)
[^4]: [Python Micromamba + Poetry ç¯å¢ƒç®¡ç†#Micromamba çš„å®‰è£…ä¸é…ç½®](../2b9c7abe1d255b7d5bce4c9b3e11ee7195afffb4/#Micromamba çš„å®‰è£…ä¸é…ç½®)
[^5]: [How do I add a python package built by poetry to another python project with poetry? - Stack Overflow](https://stackoverflow.com/questions/59621373/how-do-i-add-a-python-package-built-by-poetry-to-another-python-project-with-poe)
[^6]: [Commands | Documentation | Poetry - Python dependency management and packaging made easy](https://python-poetry.org/docs/cli/#add)

**Backlinks:**

- [Python å¼€å‘ç¯å¢ƒ](../293983b1ba374aae7708250721a2366501937648)

{% pullquote mindmap mindmap-md %}
- ğŸ”µ
  - [Fish æ·»åŠ  PATH è·¯å¾„(ç¯å¢ƒå˜é‡)](../e13093cac8ccdc5b3204f4d66ee9a7db927ce606)
  - [Python Micromamba + Poetry ç¯å¢ƒç®¡ç†#Micromamba çš„å®‰è£…ä¸é…ç½®](../2b9c7abe1d255b7d5bce4c9b3e11ee7195afffb4/#Micromamba çš„å®‰è£…ä¸é…ç½®)
  - [Python Micromamba + Poetry ç¯å¢ƒç®¡ç†](../2b9c7abe1d255b7d5bce4c9b3e11ee7195afffb4)
  - [_Linux å¸¸ç”¨å‘½ä»¤#ç¯å¢ƒå˜é‡](../06ebd355770738c865ee28ef13d2206bbfb36692/#ç¯å¢ƒå˜é‡)
  - [Python å¼€å‘ç¯å¢ƒ](../293983b1ba374aae7708250721a2366501937648)
  - [Poetry add æŠ¥é”™ xxx not found in known hashes](../8efeac92a7aadd61a7f9c1413a43c9943393b97e)
{% endpullquote %}